/* ================= Base & Tokens ================= */
:root{
  --day-col: 7rem;           /* width of each day column */
  --sticky-col: 7rem;        /* width of left sticky column */
  --radius: 8px;

  --c-app-bg: #f4f7fa;
  --c-panel: #fff;
  --c-border: #aab3c1;
  --c-border-strong: #cbd5e0;
  --c-text: #2d3748;
  --c-text-muted: #4a5568;
  --c-text-subtle: #5f6875;

  --c-green: #48bb78;
  --c-blue: #4299e1;
  --c-range: #2b6cb0;

  --c-note-bg: #edf2f7;
  --c-today-bg: #ebf8ff;
  --c-grid-today-fill: rgba(66,153,225,.12);
  --c-grid-today-border: rgba(66,153,225,.35);
}

* { box-sizing: border-box; }

/* ================= Layout ================= */
.plan-container{ padding:1rem; background:var(--c-app-bg); min-height:100vh; }
.plan-header{ display:flex; flex-direction:column; align-items:center; gap:1.25rem; margin-bottom:2rem; }
h1{ font-size:2rem; color:#1a202c; font-weight:700; }
.controls{ display:flex; flex-direction:column; gap:1.5rem; }

/* ================= Month Selector ================= */
.month-selector{
  display:flex; align-items:center; justify-content:space-between;
  background:var(--c-panel); border-radius:var(--radius);
  box-shadow:0 1px 3px rgba(0,0,0,.1); padding:.25rem;
}
.month-selector button{
  background:none; border:none; cursor:pointer; font-size:1.5rem; font-weight:900; color:#4a5568;
  padding:.5rem 1rem; border-radius:6px; transition:background-color .2s;
}
.month-selector button:hover{ background:#edf2f7; }
.month-selector span{ font-size:1.4rem; font-weight:600; color:var(--c-text); padding:0 1rem; min-width:150px; text-align:center; }

/* ================= View Switcher ================= */
.view-switcher{ display:flex; background:#e2e8f0; border-radius:var(--radius); padding:.25rem; }
.view-switcher button{
  background:none; border:none; padding:.75rem 1.5rem; cursor:pointer;
  font-size:1.2rem; font-weight:600; color:#4a5568; border-radius:6px; transition:all .3s ease;
}
.view-switcher button.active{ background:var(--c-panel); color:var(--c-text); box-shadow:0 1px 3px rgba(0,0,0,.1); }

/* ================= Table Shell ================= */
.table-container{
  max-height: 100vh;
  overflow:auto; border:1px solid var(--c-border); border-radius:12px; background:var(--c-panel);
  box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);
  -webkit-overflow-scrolling:touch;
  cursor: grab;
}
.table-container.dragging {
  cursor: grabbing;
  user-select: none;
}
.table-container.dragging .hit-cell,
.table-container.dragging .schedule-bar {
  pointer-events: none;
}

.operational-table{
  table-layout:fixed; border-collapse:separate; border-spacing:0; width:auto; /* sticky + (days * 7rem) */
}
.col-sticky{ width:var(--sticky-col); min-width:var(--sticky-col); }
.col-day   { width:var(--day-col);    min-width:var(--day-col); }

.header-date, .header-project{
  position:sticky; top:0; z-index:10;
} 

.operational-table th,
.operational-table td{
  text-align:center; border-right:1px solid var(--c-border); border-bottom:1px solid var(--c-border);
  min-width:0; /* let colgroup control column width */
}
.operational-table th:last-child,
.operational-table td:last-child{ border-right:none; }
.operational-table tr:last-child td{ border-bottom:none; }

/* ================= Table Header ================= */
.header-date{ font-weight:600; color:#4a5568; background:#f7fafc; }
.date-cell-content{ display:flex; flex-direction:column; align-items:center; justify-content:center; }
.day-initial{ font-size:1rem; color:var(--c-text-subtle); }
.day-number{ font-size:1rem; font-weight:700; }
.header-date.today .day-number{ color:rgb(31,31,243); display:inline-block; scale:1.5; }

/* ================= Sticky Column ================= */
.sticky-col{
  position:sticky; left:0; z-index:10; background:var(--c-panel);
  border-right:2px solid var(--c-border-strong);
  box-shadow:2px 0 0 var(--c-border-strong), 4px 0 12px rgba(0,0,0,.04);
}
thead .sticky-col{ z-index:20; background:#f7fafc; }
.header-project{ text-align:left; font-size:1rem; }
.cell-project{ padding-inline: 0.5rem; text-align:left; font-weight:600; color:var(--c-text); font-size:1rem; vertical-align:middle; }

/* ================= Generic Data Cells (member view, etc.) ================= */
.data-cell{ min-height:60px; height:auto; vertical-align:middle; }
.data-cell.has-data{ padding:4px; }
.data-cell.today-cell{ background:var(--c-today-bg); }

/* In member view bars, make the project label fill the whole span */
.grid-bar .project-tag { width: 100%; max-width: 100%; }

/* ================= Pills / Notes ================= */
.member-tag, .project-tag{
  display:block; color:#fff; padding:.25rem; border-radius:6px; font-size:1rem; font-weight:500; text-align:center;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.member-tag{ background:var(--c-blue); }
.project-tag{ background:var(--c-green); }

.note-text{
  width:var(--day-col); font-size:1rem; color:var(--c-text-muted);
  background:var(--c-note-bg); border-radius:6px; padding:.35rem .5rem; line-height:1.2;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.today-cell .note-text{ background:#e6f0fa; }
.text-wrap{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* ================= Data Management Links ================= */
.data-management{ display:flex; gap:.5rem; margin:.75rem 0 1rem; flex-wrap:wrap; justify-content:center; }
.dm-link{
  display:inline-flex; align-items:center; justify-content:center;
  padding:.5rem .9rem; border-radius:var(--radius); background:#fff; color:var(--c-text);
  font-weight:600; font-size:1.4rem; border:1px solid var(--c-border); box-shadow:0 1px 2px rgba(0,0,0,.04);
  text-decoration:none; transition:background-color .15s, border-color .15s, box-shadow .15s, transform .06s;
}
.dm-link:hover{ background:#f7fafc; border-color:var(--c-border-strong); box-shadow:0 2px 6px rgba(0,0,0,.06); transform:translateY(-1px); }
.dm-link:focus{ outline:none; box-shadow:0 0 0 3px rgba(49,130,206,.2); border-color:#3182ce; }
.dm-link:active{ transform:translateY(0); }

/* ================= Project View (Grid bars that auto-wrap on overlap) ================= */
.grid-cell{ position: relative; padding:1rem  0; }
.row-grid{
  position: relative;
  display:grid;
  grid-template-columns:repeat(var(--days), var(--day-col));
  grid-auto-rows:minmax(40px,auto);
  row-gap:6px; column-gap:0; position:relative;
}
/* vertical day dividers under bars */
.row-grid::after{
  content:''; position:absolute; inset:0; pointer-events:none; z-index:0;
  background-image:repeating-linear-gradient(
    to right,
    transparent 0,
    transparent calc(var(--day-col) - 1px),
    var(--c-border) calc(var(--day-col) - 1px),
    var(--c-border) var(--day-col)
  );
}

/* range bar */
.grid-bar{
  display:flex; flex-direction:column; gap:4px; padding:4px; z-index:2; /* bars above hit layer */
}
.grid-bar .member-tag, .grid-bar .note-text{ width:100%; max-width:100%; }
.grid-bar .member-tag{
  background:var(--c-range); color:#fff; border:none; padding:.35rem .5rem; border-radius:8px; line-height:1.15;
}
.grid-bar .note-text{ background:rgb(192, 220, 255); color:var(--c-text); border:1px dashed var(--c-border); }
.grid-bar:hover .member-tag{
  box-shadow:0 0 0 2px rgba(43,108,176,.2), 0 4px 10px rgba(0,0,0,.06);
  transform:translateY(-1px); transition:box-shadow .15s, transform .1s;
}

/* ================= Clickable day cells (under bars) ================= */
.hit-cell{
  z-index:1;
  justify-self: center;
  width: fit-content;
  height: fit-content;
  background:transparent;
  padding: 0.2rem 0.7rem;
  border: none;
  border-radius: 9999px;
  cursor:cell;
  touch-action:manipulation;
  font-size: 2rem;
  color: rgb(205, 205, 205);
}
.hit-cell:hover{
  transform:translateY(-2px);
  scale: 1.2;
  transition:all .2s;
}
.hit-cell:focus-visible{
  outline:2px solid rgba(49,130,206,.6);
  outline-offset:1px;
  background:rgba(2,132,199,.08);
}

/* ================= Legacy colSpan range (kept if needed elsewhere) ================= */
.range-cell{ padding:4px; background:transparent; border:none; }
.range-cell .cell-lines{ align-items:stretch; }
.range-cell .member-tag, .range-cell .note-text{ width:100%; max-width:100%; white-space:nowrap; }
.range-cell .member-tag{ background:var(--c-range); color:#fff; border:none; padding:.35rem .5rem; border-radius:8px; line-height:1.15; }
.range-cell .note-text{ background:rgba(43,108,176,.10); color:var(--c-text); border:1px dashed var(--c-border); }


/* Full-height “today” overlay aligned to the correct day column */
.today-marker-abs {
  position: absolute;
  top: 0;
  bottom: 0;
  left: calc(var(--col) * var(--day-col));
  width: var(--day-col);

  background: var(--c-grid-today-fill);
  border-left: 1px solid var(--c-grid-today-border);
  border-right: 1px solid var(--c-grid-today-border);

  pointer-events: none;   /* don’t block hover/clicks */
  z-index: 1;             /* above dividers (::after), below bars */
}

/* ================= Quick Add Modal ================= */
.modal-backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.35);
  display:flex; align-items:center; justify-content:center; z-index:1000;
}
.modal-card{
  width:min(560px, 92vw);
  max-height: 96vh;
  background:#fff; border-radius:12px; padding:16px 18px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
  overflow-y: auto;
}
.modal-card h3{ margin:0 0 10px; }
.form-row{ display:grid; gap:6px; margin:8px 0; }
.modal-actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:12px; }

/* Inputs inside modal — match AddProject look */
.modal-card input,
.modal-card select,
.modal-card textarea{
  background:#fff;
  border:1px solid #cbd5e0;
  border-radius:8px;
  padding:10px 12px;
  color:#1a202c;
  outline:none;
  transition:border-color .15s ease, box-shadow .15s ease;
}
.modal-card input::placeholder,
.modal-card textarea::placeholder{ color:#a0aec0; }
.modal-card input:focus,
.modal-card select:focus,
.modal-card textarea:focus{
  border-color:#3182ce;
  box-shadow:0 0 0 3px rgba(49,130,206,0.15);
}

/* ================= Buttons (shared with AddProject look) ================= */
.btn{
  background-color:#edf2f7;
  color:#2d3748;
  border:1px solid #cbd5e0;
  border-radius:8px;
  padding:8px 12px;
  font-size:.9rem;
  font-weight:600;
  cursor:pointer;
  transition:background-color .15s ease, border-color .15s ease;
}
.btn:hover{ background-color:#e2e8f0; }
.btn:disabled{ opacity:.6; cursor:not-allowed; }
.btn.primary{ background-color:#3182ce; border-color:#2b6cb0; color:#fff; }
.btn.primary:hover{ background-color:#2b6cb0; }
.btn.danger{ background-color:#e53e3e; border-color:#c53030; color:#fff; }
.btn.danger:hover{ background-color:#c53030; }
.btn.ghost{ background-color:transparent; border-color:#cbd5e0; color:#2d3748; }

.schedule-bar{
  cursor: pointer;
}
.schedule-bar:hover{
  scale: 1.02;
}

/* --- Fullscreen layout --- */
.main-view.fullscreen {
  position: fixed;
  inset: 0;                  /* top:0; right:0; bottom:0; left:0 */
  width: 100vw;
  height: 100vh;
  z-index: 998;               /* below the button */
  background: #fff;          /* ensure a clean canvas; adjust if you use dark */
  overflow: auto;            /* allow scroll within fullscreen content */
}

/* Optional: slightly dim the rest of the page when fullscreen */
.plan-container[data-fullscreen="1"] .plan-header {
  /* header stays in DOM; you can hide or fade if desired */
  opacity: 0.0;              /* or 0.5 for dim; or display:none if you prefer */
  pointer-events: none;
}

/* --- Fullscreen toggle button --- */
.full-screen-plan-btn {
  width: fit-content;
  align-self: center;
  padding: 0.5rem 1rem;
  border: 1px solid #cbd5e0;
  background: #f7fafc;
  border-radius: 8px;
  font-size: 1.4rem;
  cursor: pointer;
  transition: background .15s ease, transform .05s ease;
}

.full-screen-btn-inner{
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 5px;
}

.full-screen-icon {
  font-size: 2rem;
  font-weight: 900;
}

.full-screen-plan-btn:hover {
  background: #edf2f7;
}

.full-screen-plan-btn:active {
  transform: translateY(1px);
}

/* When fullscreen: pin button to top-right, above the main-view */
.full-screen-plan-btn.fixed {
  position: fixed;
  bottom: 12px;
  right: 12px;
  z-index: 999; /* above .main-view.fullscreen */
}

